var app=angular.module("dateRepeat",[]);app.controller("dateRepeatCtrl",["$scope",function($scope){$scope.dataRepeat=[{name:"Daily",key:"d",sing:"days",options:["S","M","T","W","T","F","S"]},{name:"Weekly",key:"w",sing:"weeks",options:["S","M","T","W","T","F","S"]},{name:"Monthly",key:"m",sing:"months",options:["S","M","T","W","T","F","S"]},{name:"Yearly",key:"y",sing:"years",options:["S","M","T","W","T","F","S"]}],$scope.selectedOption=$scope.dataRepeat[1],$scope.getDateSpec=function(format,date){var today=new Date,dd=today.getDate(),mm=today.getMonth()+1,yyyy=today.getFullYear(),w=today.getDay();if("string"==typeof date&&""!=date)var today=new Date(date),dd=today.getDate()+1,mm=today.getMonth(),yyyy=today.getFullYear(),w=today.getDay();var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],weekdayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return"y"==format?monthNames[mm]+" "+dd:"m"==format?"day "+dd:"w"==format?weekdayNames[w]:yyyy+"-"+mm+"-"+dd},$scope.repeatOn=function(){return"w"==$scope.selectedOption.key?!0:!1},$scope.selectedOptionValues=function(){return $scope.selectedOption==$scope.dataRepeat[1]?$scope.selectedOption.options:[]},$scope.summary=$scope.selectedOption.name+" on "+$scope.getDateSpec("w"),$scope.applySummary=function(){var val=document.querySelector(".every").value;$scope.summary=val>1?"Every "+val+" "+$scope.selectedOption.sing+$scope.makeOn($scope.selectedOption):$scope.selectedOption.name+$scope.makeOn($scope.selectedOption),$scope.$apply()},$scope.confirmSummary=function(){var item=document.querySelector(".tooltip");item.innerHTML=$scope.summary,item.setAttribute("data-title","Click to change date"),document.querySelector(".modal").style.display="none"},$scope.makeOn=function(when){var date=document.querySelector(".date").value;return"w"==when.key?" on "+$scope.getSelectedWeekdays():"m"==when.key?" on "+$scope.getDateSpec("m",date):"d"==when.key?"":"y"==when.key?" on "+$scope.getDateSpec("y",date):""},$scope.getSelectedWeekdays=function(){var s=document.querySelectorAll('input[name="weekRepeatOn"]:checked'),itens=[];return Object.keys(s).forEach(function(key){s.length>key&&itens.push(s[key].value)}),7==itens.length?"all days":itens.length<=0?$scope.getDateSpec("w"):itens.join(", ")},$scope.showDatePicker=function(){document.querySelector(".modal").style.display="block"}}]),app.filter("range",function(){return function(input,total){total=parseInt(total);for(var i=0;total>i;i++)input.push(i);return input}});